{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Fragment,useEffect,useState}from'react';import Modal from'react-modal';import{useDispatch,useSelector}from'react-redux';import'./style.scss';import*as Routes from'../../routes';import{showModal,hideModal}from'../../../redux/modal/modalActions';import{useHistory}from'react-router-dom';import{createPostFunc}from'../../../redux/Actions/postActions';import*as Icon from'react-feather';import cogoToast from'cogo-toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewPostModal=function NewPostModal(_ref){var file=_ref.file;var modalIsOpen=useSelector(function(_ref2){var modal=_ref2.modal;return modal.showModal;});var dispatch=useDispatch();var history=useHistory();var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),previewImage=_useState2[0],setPreviewImage=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),caption=_useState4[0],setCaption=_useState4[1];// console.log(file)\nuseEffect(function(){dispatch(showModal());return function(){return null;};},[]);useEffect(function(){if(file.type=='image/jpeg'||file.type=='image/png'){var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(event){setPreviewImage(event.target.result);};}else{//\n}return function(){return null;};},[file]);var closeModal=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(hideModal());history.push(Routes.Dashboard);case 2:case\"end\":return _context.stop();}}},_callee);}));return function closeModal(){return _ref3.apply(this,arguments);};}();var handlePost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;_context2.next=4;return new FormData();case 4:data=_context2.sent;data.append('postfile',file);data.append('caption',caption);console.log(data.get('postfile'),data.get('caption'));_context2.next=10;return dispatch(createPostFunc(data,history));case 10:history.push(Routes.Dashboard);_context2.next=16;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0.message);case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[1,13]]);}));return function handlePost(_x){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"modal__wrapper\",children:/*#__PURE__*/_jsxs(Modal,{isOpen:modalIsOpen,onRequestClose:closeModal,className:\"modal\",overlayClassName:\"overlay\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal__header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"goback__btn\",onClick:closeModal,children:/*#__PURE__*/_jsx(Icon.ArrowLeft,{})}),/*#__PURE__*/_jsxs(\"button\",{className:\"share__btn\",type:\"submit\",onClick:handlePost,children:[' ',\"Share\"]})]}),/*#__PURE__*/_jsx(\"small\",{children:\" New Post\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\" write a Caption\",className:\"caption__box\",name:\"caption\",id:\"caption\",type:\"text\",style:{resize:'none'},value:caption,onChange:function onChange(e){return setCaption(e.target.value);}}),previewImage&&/*#__PURE__*/_jsx(\"div\",{className:\"preview__wrapper\",children:/*#__PURE__*/_jsx(\"img\",{src:previewImage,className:\"preview\",alt:\"image\"})})]})});};export default NewPostModal;","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/component/NewPost/NewPostModal/index.js"],"names":["React","Fragment","useEffect","useState","Modal","useDispatch","useSelector","Routes","showModal","hideModal","useHistory","createPostFunc","Icon","cogoToast","NewPostModal","file","modalIsOpen","modal","dispatch","history","undefined","previewImage","setPreviewImage","caption","setCaption","type","reader","FileReader","readAsDataURL","onload","event","target","result","closeModal","push","Dashboard","handlePost","e","preventDefault","FormData","data","append","console","log","get","message","resize","value"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect, useState } from 'react';\nimport Modal from 'react-modal';\nimport { useDispatch, useSelector } from 'react-redux';\nimport './style.scss';\nimport * as Routes from '../../routes';\nimport { showModal, hideModal } from '../../../redux/modal/modalActions';\nimport { useHistory } from 'react-router-dom';\nimport { createPostFunc } from '../../../redux/Actions/postActions';\n\nimport * as Icon from 'react-feather';\nimport cogoToast from 'cogo-toast';\n\nconst NewPostModal = ({ file }) => {\n  const modalIsOpen = useSelector(({ modal }) => modal.showModal);\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const [previewImage, setPreviewImage] = useState(undefined);\n  const [caption, setCaption] = useState('');\n\n  // console.log(file)\n\n  useEffect(() => {\n    dispatch(showModal());\n    return () => null;\n  }, []);\n\n  useEffect(() => {\n    if (file.type == 'image/jpeg' || file.type == 'image/png') {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = (event) => {\n        setPreviewImage(event.target.result);\n      };\n    } else {\n      //\n    }\n    return () => null;\n  }, [file]);\n\n  const closeModal = async () => {\n    dispatch(hideModal());\n    history.push(Routes.Dashboard);\n  };\n\n  const handlePost = async (e) => {\n    e.preventDefault();\n    try {\n      // if (!file) {\n      //     cogoToast.warn('no picture has been selected');\n      // }\n\n      const data = await new FormData();\n      data.append('postfile', file);\n      data.append('caption', caption);\n      console.log(data.get('postfile'), data.get('caption'));\n      await dispatch(createPostFunc(data, history));\n      history.push(Routes.Dashboard);\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n  return (\n    <div className=\"modal__wrapper\">\n      <Modal\n        isOpen={modalIsOpen}\n        onRequestClose={closeModal}\n        className=\"modal\"\n        overlayClassName=\"overlay\"\n      >\n        <div className=\"modal__header\">\n          <button className=\"goback__btn\" onClick={closeModal}>\n            <Icon.ArrowLeft />\n          </button>\n          <button className=\"share__btn\" type=\"submit\" onClick={handlePost}>\n            {' '}\n            Share\n          </button>\n        </div>\n        <small> New Post</small>\n        {/* caption */}\n        <input\n          placeholder=\" write a Caption\"\n          className=\"caption__box\"\n          name=\"caption\"\n          id=\"caption\"\n          type=\"text\"\n          style={{ resize: 'none' }}\n          value={caption}\n          onChange={(e) => setCaption(e.target.value)}\n        />\n\n        {/* preview image */}\n\n        {previewImage && (\n          <div className=\"preview__wrapper\">\n            <img src={previewImage} className=\"preview\" alt=\"image\" />\n          </div>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\nexport default NewPostModal;\n"]},"metadata":{},"sourceType":"module"}