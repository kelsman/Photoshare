{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectDestructuringEmpty from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";import React,{Fragment,useState,useRef,useEffect}from'react';import'./style.scss';import axios from'axios';import{setToken}from'../../utils';import*as Icon from'react-feather';import*as Routes from'../routes';import Divider from'../Divider';import PopUpCard from'../UsersPopUpCard/PopUpCard';import Loader from'../Loader';import Avatar from'../../assets/default-avatar.png';import{v4 as uuidv4}from'uuid';import{useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var token=localStorage.getItem('authToken');var SearchBox=function SearchBox(_ref){_objectDestructuringEmpty(_ref);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),userDetails=_useState4[0],setUserDetails=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),isSearching=_useState6[0],setIsSearching=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),errorMsg=_useState8[0],setErrorMsg=_useState8[1];var inputRef=useRef();var history=useHistory();var fetchUsers=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(query){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(token){setToken(token);}_context.prev=1;_context.next=4;return setIsSearching(true);case 4:_context.next=6;return setQuery(query);case 6:_context.next=8;return axios.get(\"/api/route/user/search-users/\".concat(query));case 8:res=_context.sent;if(!res){_context.next=14;break;}_context.next=12;return setUserDetails(res.data.users);case 12:_context.next=14;return setIsSearching(false);case 14:_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](1);console.log(_context.t0.message);if(_context.t0.response){setErrorMsg(_context.t0.response.data.msg);setIsSearching(false);}case 20:case\"end\":return _context.stop();}}},_callee,null,[[1,16]]);}));return function fetchUsers(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(query.length<1){setUserDetails([]);}return function(){return null;};},[query]);return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{className:\"search-box\",onSubmit:function onSubmit(event){return event.preventDefault();},children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,onChange:function onChange(e){return fetchUsers(e.target.value);},onClick:function onClick(_onClick){return console.log('serach ready');},value:query,className:\"search-box__input\",placeholder:\"Search\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"search-box__placeholder\",children:[/*#__PURE__*/_jsx(Icon.Search,{className:\"searchbox__icon\",size:16}),isSearching&&query.length>0&&/*#__PURE__*/_jsx(Loader,{})]})]}),isSearching===false&&query.length>0&&/*#__PURE__*/_jsxs(PopUpCard,{hide:function hide(){return setQuery('');},children:[userDetails&&userDetails.length>0&&userDetails.map(function(_ref3,idx){var avatar=_ref3.avatar,name=_ref3.name,username=_ref3.username;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"li\",{className:\"search__list\",onClick:function onClick(){return history.push(Routes.ProfilePage+\"/\".concat(username));},children:[/*#__PURE__*/_jsx(\"img\",{src:avatar?avatar:Avatar,alt:\"\",width:30,height:30}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{children:username}),/*#__PURE__*/_jsx(\"h6\",{children:name})]})]}),userDetails.length!==idx+1&&/*#__PURE__*/_jsx(Divider,{})]},uuidv4());}),errorMsg&&userDetails.length===0&&/*#__PURE__*/_jsxs(\"p\",{children:[\" \",errorMsg]})]})]});};export default SearchBox;","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/component/SearchBox/SearchBox.js"],"names":["React","Fragment","useState","useRef","useEffect","axios","setToken","Icon","Routes","Divider","PopUpCard","Loader","Avatar","v4","uuidv4","useHistory","token","localStorage","getItem","SearchBox","query","setQuery","userDetails","setUserDetails","undefined","isSearching","setIsSearching","errorMsg","setErrorMsg","inputRef","history","fetchUsers","get","res","data","users","console","log","message","response","msg","length","event","preventDefault","e","target","value","onClick","map","idx","avatar","name","username","push","ProfilePage"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useRef, useEffect } from 'react';\nimport './style.scss';\nimport axios from 'axios';\nimport { setToken } from '../../utils'\nimport * as Icon from 'react-feather';\nimport * as Routes from '../routes';\nimport Divider from '../Divider'\n\n\nimport PopUpCard from '../UsersPopUpCard/PopUpCard';\nimport Loader from '../Loader';\nimport Avatar from '../../assets/default-avatar.png';\nimport { v4 as uuidv4 } from 'uuid';\nimport { useHistory } from 'react-router-dom'\nconst token = localStorage.getItem('authToken');\n\nconst SearchBox = ({ }) => {\n  const [query, setQuery] = useState('');\n  const [userDetails, setUserDetails] = useState([])\n  const [isSearching, setIsSearching] = useState(undefined);\n  const [errorMsg, setErrorMsg] = useState('')\n  const inputRef = useRef();\n  const history = useHistory();\n\n  const fetchUsers = async (query) => {\n    if (token) {\n      setToken(token)\n    }\n    try {\n      await setIsSearching(true)\n      await setQuery(query);\n\n      const res = await axios.get(`/api/route/user/search-users/${query}`)\n      if (res) {\n        await setUserDetails(res.data.users);\n        await setIsSearching(false);\n\n\n      }\n\n    } catch (error) {\n      console.log(error.message)\n      if (error.response) {\n        setErrorMsg(error.response.data.msg)\n        setIsSearching(false)\n\n      }\n    }\n  }\n  useEffect(() => {\n    if (query.length < 1) {\n      setUserDetails([])\n    }\n    return () => null\n  }, [query])\n  return (\n    <Fragment>\n      <form className=\"search-box\" onSubmit={(event) => event.preventDefault()}>\n        <input\n          ref={inputRef}\n          onChange={(e) => fetchUsers(e.target.value)}\n          onClick={(onClick) => console.log('serach ready')}\n          value={query}\n          className=\"search-box__input\"\n          placeholder=\"Search\"\n        />\n        <span className=\"search-box__placeholder\">\n          <Icon.Search className=\"searchbox__icon\" size={16} />\n          {/* fetching && <Loader /> */}\n          {isSearching && query.length > 0 && <Loader />}\n        </span>\n      </form>\n      {isSearching === false && query.length > 0 && (\n        <PopUpCard hide={() => setQuery('')}>\n          { userDetails && userDetails.length > 0 && userDetails.map(({ avatar, name, username }, idx) => {\n            return (\n              <Fragment key={uuidv4()}>\n                <li className=\"search__list\"\n                  onClick={() => history.push(Routes.ProfilePage + `/${username}`)}\n                >\n                  <img src={avatar ? avatar : Avatar} alt=\"\" width={30} height={30} />\n                  <div>\n                    <h5>{username}</h5>\n                    <h6>{name}</h6>\n                  </div>\n                </li>\n                { userDetails.length !== idx + 1 && <Divider />}\n              </Fragment>\n            )\n          })}\n          {errorMsg && userDetails.length === 0 && <p> {errorMsg}</p>}\n        </PopUpCard>\n\n      )}\n    </Fragment>\n  );\n};\n\nexport default SearchBox;\n"]},"metadata":{},"sourceType":"module"}