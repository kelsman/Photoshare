{"ast":null,"code":"import * as postActionTypes from '../Constants/postConstants';\nimport { setToken } from '../../utils';\nimport axios from 'axios';\nimport cogoToast from 'cogo-toast';\nimport * as Routes from '../../component/routes';\nconst token = localStorage.getItem('authToken');\nconst baseUrl = process.env.REACT_APP_BASE_URL || \"http://localhost:9000\"; // @create post \n\nexport const createPostFunc = data => {\n  const token = localStorage.getItem('authToken');\n  return async dispatch => {\n    try {\n      if (token) {\n        await setToken(token);\n      }\n\n      ;\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const response = await axios.post('/api/route/post/createPost', config, data);\n\n      if (response) {\n        await dispatch({\n          type: postActionTypes.CREATE_POST_SUCCESS,\n          payload: response.data.msg\n        });\n        cogoToast.success('post created');\n      }\n    } catch (error) {\n      if (error.response) {\n        await dispatch({\n          type: postActionTypes.CREATE_POST_FAIL,\n          payload: error.response.data\n        });\n\n        if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n          history.push('/');\n          localStorage.removeItem('authToken');\n          cogoToast.info('session expired');\n        }\n      }\n    }\n  };\n}; //  load explore posts \n\nexport const getPosts = history => {\n  return async dispatch => {\n    const token = localStorage.getItem('authToken');\n\n    try {\n      if (token) {\n        await setToken(token);\n      }\n\n      ;\n      const response = await axios.get(`/api/route/post/retrieveExplorePost`);\n\n      if (response) {\n        dispatch({\n          type: postActionTypes.GET_POSTS_SUCCESS,\n          payload: response.data.posts\n        });\n      }\n\n      ;\n    } catch (error) {\n      if (error.response) {\n        console.log(error.response.data);\n        await dispatch({\n          type: postActionTypes.GET_POSTS_FAIL,\n          payload: error.response.data\n        });\n\n        if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n          localStorage.removeItem('authToken');\n          history.push('/');\n        } // cogoToast.error(`${error.response.data.msg}`, { position: \"top-right\" })\n\n      }\n    }\n  };\n}; //  @comment on a post with a given post id passed as a param to the url\n\nexport const commentPost = (postId, commentText, socket, history) => {\n  return async dispatch => {\n    if (token) {\n      await setToken(token);\n    }\n\n    ;\n\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const response = await axios.post(`/api/route/post/comment/${postId}`, {\n        commentText\n      });\n\n      if (response) {\n        dispatch({\n          type: postActionTypes.COMMENT_POST_SUCCESS,\n          payload: response.data.data\n        });\n        console.log(response.data.data);\n      }\n\n      ;\n    } catch (error) {\n      if (error.response) {\n        console.log(error.response.data);\n        await dispatch({\n          type: postActionTypes.COMMENT_POST_FAIL,\n          payload: error.response.data.msg\n        });\n\n        if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n          localStorage.removeItem('authToken');\n          history.push('/');\n        } // cogoToast.error(`${error.response.data.msg}`, { position: \"top-right\" })\n\n      }\n    }\n  };\n}; // @delete a commment \n\nexport const deleteComment = (postid, commentid, history) => async dispatch => {\n  try {\n    if (token) {\n      await setToken(token);\n    }\n\n    ;\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const response = await axios.put(`/api/route/post/deleteComment/${postid}/${commentid}`, config);\n\n    if (response) {\n      console.log(response.data);\n      dispatch({\n        type: postActionTypes.DELETE_COMMENT_SUCCESS,\n        payload: response.data.data\n      });\n    }\n  } catch (error) {\n    if (error.response) {\n      console.log(error.response.data);\n      await dispatch({\n        type: postActionTypes.DELETE_COMMENT_FAIL,\n        payload: error.response.data.msg\n      });\n\n      if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n        localStorage.removeItem('authToken');\n        history.push('/');\n      }\n    }\n  }\n};\nexport const getSinglePost = (postId, history) => {\n  return async dispatch => {\n    if (token) {\n      await setToken(token);\n    }\n\n    ;\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n\n    try {\n      const response = await axios.get(`/api/route/post/singlePost/${postId}`, config);\n\n      if (response) {\n        dispatch({\n          type: postActionTypes.GET_SINGLE_POST_SUCCESS,\n          payload: response.data.post[0]\n        });\n      }\n\n      ;\n    } catch (error) {\n      if (error.response) {\n        console.log(error.response.data);\n        await dispatch({\n          type: postActionTypes.GET_SINGLE_POST_FAIL,\n          payload: error.response.data.msg\n        });\n\n        if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n          localStorage.removeItem('authToken');\n          history.push('/');\n        }\n      }\n    }\n  };\n}; //  like & unlike  a post \n\nexport const likePost = (postId, socket, history) => {\n  return async dispatch => {\n    const token = localStorage.getItem('authToken');\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n\n    if (token) {\n      await setToken(token);\n    }\n\n    ;\n\n    try {\n      const response = await axios.put(`/api/route/post/likePost/${postId}`, config);\n\n      if (response) {\n        dispatch({\n          type: postActionTypes.LIKE_POST_SUCCESS,\n          payload: response.data.data\n        });\n      }\n    } catch (error) {\n      if (error.response) {\n        console.log(error.response.data);\n        await dispatch({\n          type: postActionTypes.LIKE_POST_FAIL,\n          payload: error.response.data.msg\n        });\n        cogoToast.info(`${error.response.data.msg}`, {\n          position: 'top-center'\n        });\n\n        if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n          localStorage.removeItem('authToken');\n          history.push('/');\n        }\n      }\n    }\n  };\n}; //  load feed posts \n\nexport const retrieveFeedPosts = history => async dispatch => {\n  const token = localStorage.getItem('authToken');\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  };\n\n  if (token) {\n    await setToken(token);\n  }\n\n  ;\n\n  try {\n    const response = await axios.get(`api/route/post/retrieveFeedPosts`, config);\n\n    if (response) {\n      console.log(response.data);\n      dispatch({\n        type: postActionTypes.GET_FEEDS_SUCCESS,\n        payload: response.data.posts\n      });\n    }\n  } catch (error) {\n    if (error.response) {\n      console.log(error.response.data);\n      await dispatch({\n        type: postActionTypes.GET_FEEDS_FAIL,\n        payload: error.response.data.msg\n      });\n      cogoToast.info(`${error.response.data.msg}`, {\n        position: 'top-center'\n      });\n\n      if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n        history.push('/');\n        localStorage.removeItem('authToken');\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/redux/Actions/postActions.js"],"names":["postActionTypes","setToken","axios","cogoToast","Routes","token","localStorage","getItem","baseUrl","process","env","REACT_APP_BASE_URL","createPostFunc","data","dispatch","config","headers","response","post","type","CREATE_POST_SUCCESS","payload","msg","success","error","CREATE_POST_FAIL","history","push","removeItem","info","getPosts","get","GET_POSTS_SUCCESS","posts","console","log","GET_POSTS_FAIL","commentPost","postId","commentText","socket","COMMENT_POST_SUCCESS","COMMENT_POST_FAIL","deleteComment","postid","commentid","put","DELETE_COMMENT_SUCCESS","DELETE_COMMENT_FAIL","getSinglePost","GET_SINGLE_POST_SUCCESS","GET_SINGLE_POST_FAIL","likePost","LIKE_POST_SUCCESS","LIKE_POST_FAIL","position","retrieveFeedPosts","GET_FEEDS_SUCCESS","GET_FEEDS_FAIL"],"mappings":"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","sourcesContent":["import * as postActionTypes from '../Constants/postConstants';\nimport { setToken } from '../../utils'\n\n\nimport axios from 'axios';\nimport cogoToast from 'cogo-toast';\nimport * as Routes from '../../component/routes';\n\nconst token = localStorage.getItem('authToken');\n\nconst baseUrl = process.env.REACT_APP_BASE_URL || \"http://localhost:9000\"\n\n\n// @create post \n\nexport const createPostFunc = (data) => {\n    const token = localStorage.getItem('authToken')\n    return async (dispatch) => {\n        try {\n            if (token) {\n                await setToken(token)\n            };\n            const config = {\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            }\n            const response = await axios.post('/api/route/post/createPost', config, data)\n            if (response) {\n                await dispatch({ type: postActionTypes.CREATE_POST_SUCCESS, payload: response.data.msg })\n                cogoToast.success('post created')\n            }\n        } catch (error) {\n            if (error.response) {\n                await dispatch({ type: postActionTypes.CREATE_POST_FAIL, payload: error.response.data })\n                if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                    history.push('/')\n                    localStorage.removeItem('authToken');\n                    cogoToast.info('session expired');\n                }\n            }\n        }\n    }\n}\n\n//  load explore posts \nexport const getPosts = (history) => {\n    return async (dispatch) => {\n        const token = localStorage.getItem('authToken')\n        try {\n            if (token) {\n                await setToken(token)\n            };\n\n            const response = await axios.get(`/api/route/post/retrieveExplorePost`);\n            if (response) {\n                dispatch({ type: postActionTypes.GET_POSTS_SUCCESS, payload: response.data.posts })\n\n            };\n\n        } catch (error) {\n            if (error.response) {\n                console.log(error.response.data)\n                await dispatch({ type: postActionTypes.GET_POSTS_FAIL, payload: error.response.data })\n                if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                    localStorage.removeItem('authToken');\n                    history.push('/')\n                }\n                // cogoToast.error(`${error.response.data.msg}`, { position: \"top-right\" })\n            }\n        }\n\n    }\n}\n\n\n\n//  @comment on a post with a given post id passed as a param to the url\nexport const commentPost = (postId, commentText, socket, history) => {\n    return async (dispatch) => {\n        if (token) {\n            await setToken(token)\n        };\n\n        try {\n            const config = {\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            }\n            const response = await axios.post(`/api/route/post/comment/${postId}`, { commentText });\n            if (response) {\n\n                dispatch({ type: postActionTypes.COMMENT_POST_SUCCESS, payload: response.data.data })\n                console.log(response.data.data)\n            };\n\n        } catch (error) {\n            if (error.response) {\n                console.log(error.response.data)\n                await dispatch({ type: postActionTypes.COMMENT_POST_FAIL, payload: error.response.data.msg })\n                if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                    localStorage.removeItem('authToken');\n                    history.push('/')\n                }\n                // cogoToast.error(`${error.response.data.msg}`, { position: \"top-right\" })\n            }\n        }\n    }\n}\n\n// @delete a commment \n\nexport const deleteComment = (postid, commentid, history) => async dispatch => {\n\n    try {\n        if (token) {\n            await setToken(token)\n        };\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }\n\n        const response = await axios.put(`/api/route/post/deleteComment/${postid}/${commentid}`, config)\n        if (response) {\n            console.log(response.data)\n            dispatch({ type: postActionTypes.DELETE_COMMENT_SUCCESS, payload: response.data.data })\n        }\n    } catch (error) {\n        if (error.response) {\n            console.log(error.response.data)\n            await dispatch({ type: postActionTypes.DELETE_COMMENT_FAIL, payload: error.response.data.msg })\n            if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                localStorage.removeItem('authToken');\n                history.push('/');\n\n            }\n        }\n    }\n}\n\nexport const getSinglePost = (postId, history) => {\n\n    return async (dispatch) => {\n\n        if (token) {\n            await setToken(token)\n        };\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }\n        try {\n            const response = await axios.get(`/api/route/post/singlePost/${postId}`, config)\n            if (response) {\n                dispatch({ type: postActionTypes.GET_SINGLE_POST_SUCCESS, payload: response.data.post[0] })\n\n            };\n\n        } catch (error) {\n            if (error.response) {\n                console.log(error.response.data)\n                await dispatch({ type: postActionTypes.GET_SINGLE_POST_FAIL, payload: error.response.data.msg })\n                if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                    localStorage.removeItem('authToken');\n                    history.push('/');\n\n                }\n            }\n        }\n    }\n}\n\n\n\n//  like & unlike  a post \n\nexport const likePost = (postId, socket, history) => {\n\n    return async (dispatch) => {\n\n        const token = localStorage.getItem('authToken');\n\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }\n        if (token) {\n            await setToken(token)\n        };\n        try {\n            const response = await axios.put(`/api/route/post/likePost/${postId}`, config);\n            if (response) {\n\n                dispatch({ type: postActionTypes.LIKE_POST_SUCCESS, payload: response.data.data })\n\n            }\n        } catch (error) {\n            if (error.response) {\n                console.log(error.response.data)\n                await dispatch({ type: postActionTypes.LIKE_POST_FAIL, payload: error.response.data.msg })\n                cogoToast.info(`${error.response.data.msg}`, { position: 'top-center' })\n                if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                    localStorage.removeItem('authToken');\n                    history.push('/');\n                }\n\n            }\n\n        }\n\n    }\n\n}\n\n\n//  load feed posts \n\nexport const retrieveFeedPosts = (history) => async dispatch => {\n\n    const token = localStorage.getItem('authToken');\n\n    const config = {\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    }\n    if (token) {\n        await setToken(token)\n    };\n    try {\n        const response = await axios.get(`api/route/post/retrieveFeedPosts`, config)\n        if (response) {\n            console.log(response.data)\n            dispatch({ type: postActionTypes.GET_FEEDS_SUCCESS, payload: response.data.posts })\n        }\n    } catch (error) {\n        if (error.response) {\n            console.log(error.response.data)\n            await dispatch({ type: postActionTypes.GET_FEEDS_FAIL, payload: error.response.data.msg })\n            cogoToast.info(`${error.response.data.msg}`, { position: 'top-center' })\n            if (error.response.data.msg === \"jwt expired\" || error.response.data.msg === `you're not authorised`) {\n                history.push('/');\n                localStorage.removeItem('authToken');\n            }\n\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}