{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{userActionTypes}from'../Constants/userConstants';import{setToken}from'../../utils';import axios from'axios';import cogoToast from'cogo-toast';import*as Routes from'../../component/routes';var baseUrl=process.env.REACT_APP_BASE_URL||\"http://localhost:9000\";export var signup=function signup(data,history){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{\"Content-Type\":\"application/json\"}};cogoToast.loading('Registering....');_context.next=5;return axios.post(\"\".concat(baseUrl,\"/api/route/user/register\"),config,data);case 5:response=_context.sent;if(!response){_context.next=11;break;}_context.next=9;return dispatch({type:userActionTypes.SIGN_UP_SUCESS,payload:response.data});case 9:cogoToast.success('Register successfully');history.push('/');case 11:_context.next=20;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);if(!_context.t0.response){_context.next=20;break;}_context.next=19;return dispatch({type:userActionTypes.SIGN_UP_FAIL,payload:_context.t0.response.data});case 19:cogoToast.error(\"\".concat(_context.t0.response.data.msg));case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signin=function signin(data){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;config={headers:{\"Content-Type\":\"application/json\"}};_context2.next=4;return axios.post(\"\".concat(baseUrl,\"/api/route/user/login\"),data,config);case 4:response=_context2.sent;if(!response){_context2.next=12;break;}_context2.next=8;return dispatch({type:userActionTypes.LOG_IN_SUCCESS,payload:response.data});case 8:_context2.next=10;return localStorage.setItem('authToken',response.data.jwtToken);case 10:_context2.next=12;return cogoToast.success('sign in success',{position:'bottom-right'});case 12:_context2.next=19;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);if(!_context2.t0.response){_context2.next=19;break;}_context2.next=19;return dispatch({type:userActionTypes.LOG_IN_FAIL,payload:_context2.t0.response.data});case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[0,14]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var loaduser=function loaduser(history){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var token,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token=localStorage.getItem('authToken');_context3.prev=1;if(token){setToken(token);}_context3.next=5;return axios.get(\"http://localhost:9000/api/route/user/getUser\");case 5:response=_context3.sent;if(!response){_context3.next=9;break;}_context3.next=9;return dispatch({type:userActionTypes.LOAD_USER_SUCCESS,payload:response.data.user});case 9:_context3.next=22;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](1);if(!_context3.t0.response){_context3.next=22;break;}_context3.next=16;return dispatch({type:userActionTypes.LOAD_USER_FAIL,payload:_context3.t0.response.data});case 16:cogoToast.warn(\"\".concat(_context3.t0.response.data.msg),{position:\"top-right\"});if(!_context3.t0.response.data.msg.includes(\"you're not authorised\")){_context3.next=21;break;}_context3.next=20;return cogoToast.info('redirected to login');case 20:history.push(Routes.Login);case 21:if(_context3.t0.response.data.msg.includes(\"jwt expired\")){localStorage.removeItem('authToken');history.push(Routes.Login);}case 22:case\"end\":return _context3.stop();}}},_callee3,null,[[1,11]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var LogOut=function LogOut(history){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return localStorage.removeItem('authToken');case 3:dispatch({type:userActionTypes.LOG_OUT_SUCCESS,payload:\"sign out sucessful\"});history.push(Routes.Login);cogoToast.success('Sign out success');_context4.next=12;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0.message);dispatch({type:userActionTypes.LOG_OUT_FAIL,payload:_context4.t0.message});case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/redux/Actions/userActions.js"],"names":["userActionTypes","setToken","axios","cogoToast","Routes","baseUrl","process","env","REACT_APP_BASE_URL","signup","data","history","dispatch","config","headers","loading","post","response","type","SIGN_UP_SUCESS","payload","success","push","console","log","message","SIGN_UP_FAIL","error","msg","signin","LOG_IN_SUCCESS","localStorage","setItem","jwtToken","position","LOG_IN_FAIL","loaduser","token","getItem","get","LOAD_USER_SUCCESS","user","LOAD_USER_FAIL","warn","includes","info","Login","removeItem","LogOut","LOG_OUT_SUCCESS","LOG_OUT_FAIL"],"mappings":"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","sourcesContent":["import { userActionTypes } from '../Constants/userConstants';\nimport { setToken } from '../../utils'\n\n\nimport axios from 'axios';\nimport cogoToast from 'cogo-toast';\nimport * as Routes from '../../component/routes';\n\nconst baseUrl = process.env.REACT_APP_BASE_URL || \"http://localhost:9000\"\n\n\nexport const signup = (data, history) => {\n    return async (dispatch) => {\n        try {\n            const config = {\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            }\n            cogoToast.loading('Registering....')\n            const response = await axios.post(`${baseUrl}/api/route/user/register`, config, data);\n            if (response) {\n                await dispatch({ type: userActionTypes.SIGN_UP_SUCESS, payload: response.data });\n                cogoToast.success('Register successfully');\n                history.push('/')\n            }\n        } catch (error) {\n            console.log(error.message)\n            if (error.response) {\n                await dispatch({ type: userActionTypes.SIGN_UP_FAIL, payload: error.response.data })\n                cogoToast.error(`${error.response.data.msg}`)\n            }\n        }\n    }\n};\n\nexport const signin = (data) => {\n    return async (dispatch) => {\n\n        try {\n            const config = {\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            };\n            const response = await axios.post(`${baseUrl}/api/route/user/login`, data, config);\n            if (response) {\n                await dispatch({ type: userActionTypes.LOG_IN_SUCCESS, payload: response.data });\n                await localStorage.setItem('authToken', response.data.jwtToken);\n                await cogoToast.success('sign in success', { position: 'bottom-right' });\n\n            }\n        } catch (error) {\n            if (error.response) {\n                await dispatch({ type: userActionTypes.LOG_IN_FAIL, payload: error.response.data });\n            }\n        }\n    }\n};\n\nexport const loaduser = (history) => {\n\n    return async (dispatch) => {\n        const token = localStorage.getItem('authToken');\n\n        try {\n            if (token) { setToken(token) }\n            const response = await axios.get(\"http://localhost:9000/api/route/user/getUser\");\n            if (response) {\n                await dispatch({ type: userActionTypes.LOAD_USER_SUCCESS, payload: response.data.user })\n\n            }\n        } catch (error) {\n            if (error.response) {\n                await dispatch({ type: userActionTypes.LOAD_USER_FAIL, payload: error.response.data })\n                cogoToast.warn(`${error.response.data.msg}`, { position: \"top-right\" });\n                if (error.response.data.msg.includes(`you're not authorised`)) {\n                    await cogoToast.info('redirected to login');\n                    history.push(Routes.Login);\n                }\n                if (error.response.data.msg.includes(`jwt expired`)) {\n                    localStorage.removeItem('authToken');\n                    history.push(Routes.Login);\n                }\n            }\n\n        }\n    }\n};\n\nexport const LogOut = (history) => {\n    return async (dispatch) => {\n        try {\n            await localStorage.removeItem('authToken');\n            dispatch({ type: userActionTypes.LOG_OUT_SUCCESS, payload: \"sign out sucessful\" })\n            history.push(Routes.Login);\n            cogoToast.success('Sign out success');\n        } catch (error) {\n            console.log(error.message)\n            dispatch({ type: userActionTypes.LOG_OUT_FAIL, payload: error.message })\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}