{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect,useCallback}from'react';import'./style.scss';import{useHistory,useParams,withRouter}from'react-router-dom';// componnets\nimport NavigationHeader from'../../component/NavigationHeader';import CommentList from'../../component/CommentList';import Profile from'../../component/Profile';import ExploreCardMenu from'../../component/ExplorePostCardMenu';import MobileTabMenu from'../../component/MobileTabMenu';import Card from'../../component/Cards/Card';// external liberires\nimport*as Icon from'react-feather';import moment from'moment';import{v4 as uuidv4}from'uuid';// redux imports\nimport{commentPost,getPosts,getSinglePost,likePost}from'../../redux/Actions/postActions';import{connect}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PostPage(_ref){var commentPost=_ref.commentPost,socket=_ref.socket,user=_ref.user,userpost=_ref.userpost,getSinglePost=_ref.getSinglePost,history=_ref.history,likePost=_ref.likePost;//    get postId from params\nvar _useParams=useParams(),postId=_useParams.postId;//  states\nvar _React$useState=React.useState(''),_React$useState2=_slicedToArray(_React$useState,2),commentText=_React$useState2[0],setCommentText=_React$useState2[1];var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];// const [isLikedButtonClicked, setIsLikedButtonClicked] = useState(false)\nvar inputRef=useRef();var focus=function focus(){inputRef.current.focus();};useEffect(function(){var subscribe=true;if(subscribe){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getSinglePost(postId,history);case 3:_context.next=5;return setIsLoading(false);case 5:_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}))();}return function(){return subscribe=null;};},[getSinglePost,postId]);//  @ functions  all functions defined here\nvar likeFunc=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return likePost(userpost._id,socket,history);case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return function likeFunc(){return _ref3.apply(this,arguments);};}();var handleCommentPost=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();console.info('submitting btn');_context3.prev=2;_context3.next=5;return commentPost(userpost._id,commentText,history);case 5:setCommentText('');_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](2);console.log(_context3.t0.message);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[2,8]]);}));return function handleCommentPost(_x){return _ref4.apply(this,arguments);};}();// const { location: { pathname, state } } = history;\nvar handleCommentTextChange=function handleCommentTextChange(e){setCommentText(e.target.value);};if(isLoading&&!userpost){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"post-page\",children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsx(NavigationHeader,{})}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"post_content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"post_image\",children:/*#__PURE__*/_jsx(\"img\",{src:userpost.postMedia,alt:\"image\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"post_details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsx(Profile,{image:userpost.author.avatar,iconSize:\"medium\",username:userpost.author.username}),/*#__PURE__*/_jsx(Icon.MoreHorizontal,{className:\"more-icon\",size:26})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-section\",children:userpost.comments&&userpost.comments.map(function(comment){return/*#__PURE__*/_jsx(CommentList,{commentId:comment._id,commentuser:comment._user,commentText:comment.commentText,userpost:userpost,accountName:comment.username,comment:comment.commentText,commentImage:comment.avatar,commentTime:comment.commentDate},uuidv4());})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card_icon_menu\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-menu\",children:/*#__PURE__*/_jsx(ExploreCardMenu,{userpost:userpost,focus:focus,likeFunc:likeFunc// isLiked={isLikedButtonClicked}\n})}),!userpost.likes?/*#__PURE__*/_jsxs(\"small\",{className:\"like-title\",children:[' ',\"Be the first to \",/*#__PURE__*/_jsx(\"b\",{children:\"like this\"})]}):/*#__PURE__*/_jsxs(\"small\",{children:[userpost.likes.length,\" Likes\"]}),/*#__PURE__*/_jsx(\"small\",{className:\"post-date\",children:moment(userpost.date).format('MMM D')})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"addComment\",onSubmit:handleCommentPost,children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,value:commentText,onChange:handleCommentTextChange,type:\"text\",placeholder:\"Add a comment...\",className:\"commentText\",name:\"commentText\"}),/*#__PURE__*/_jsx(\"button\",{disabled:commentText?false:true,type:\"submit\",className:\"postText-btn\",children:\"Post\"})]})]})]})})]});}var mapStateToProps=function mapStateToProps(_ref5){var socket=_ref5.socket,post=_ref5.post,user=_ref5.user;return{socket:socket.socket,userpost:post.post,user:user.currentUser};};export default connect(mapStateToProps,{commentPost:commentPost,getPosts:getPosts,getSinglePost:getSinglePost,likePost:likePost})(withRouter(PostPage));","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/screens/PostPage/index.js"],"names":["React","useRef","useState","useEffect","useCallback","useHistory","useParams","withRouter","NavigationHeader","CommentList","Profile","ExploreCardMenu","MobileTabMenu","Card","Icon","moment","v4","uuidv4","commentPost","getPosts","getSinglePost","likePost","connect","PostPage","socket","user","userpost","history","postId","commentText","setCommentText","isLoading","setIsLoading","inputRef","focus","current","subscribe","console","log","message","likeFunc","_id","handleCommentPost","event","preventDefault","info","handleCommentTextChange","e","target","value","postMedia","author","avatar","username","comments","map","comment","_user","commentDate","likes","length","date","format","mapStateToProps","post","currentUser"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect, useCallback } from 'react';\n\nimport './style.scss';\nimport { useHistory, useParams, withRouter } from 'react-router-dom';\n\n// componnets\nimport NavigationHeader from '../../component/NavigationHeader';\nimport CommentList from '../../component/CommentList';\nimport Profile from '../../component/Profile';\nimport ExploreCardMenu from '../../component/ExplorePostCardMenu';\nimport MobileTabMenu from '../../component/MobileTabMenu';\nimport Card from '../../component/Cards/Card';\n\n// external liberires\nimport * as Icon from 'react-feather';\nimport moment from 'moment';\nimport { v4 as uuidv4 } from 'uuid';\n\n// redux imports\nimport { commentPost, getPosts, getSinglePost, likePost } from '../../redux/Actions/postActions';\nimport { connect } from 'react-redux';\n\nfunction PostPage({ commentPost, socket, user, userpost, getSinglePost, history, likePost }) {\n  //    get postId from params\n  const { postId } = useParams();\n\n  //  states\n  const [commentText, setCommentText] = React.useState('');\n  const [isLoading, setIsLoading] = useState(true);\n  // const [isLikedButtonClicked, setIsLikedButtonClicked] = useState(false)\n  const inputRef = useRef();\n\n  const focus = () => {\n    inputRef.current.focus();\n  };\n\n  useEffect(() => {\n    let subscribe = true;\n    if (subscribe) {\n      (async function () {\n        try {\n          await getSinglePost(postId, history);\n          await setIsLoading(false);\n        } catch (error) {\n          console.log(error.message);\n        }\n      }())\n\n    }\n    return () => (subscribe = null);\n  }, [getSinglePost, postId]);\n\n  //  @ functions  all functions defined here\n\n  const likeFunc = async () => {\n    try {\n      await likePost(userpost._id, socket, history);\n      // setIsLikedButtonClicked(true)\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleCommentPost = async (event) => {\n    event.preventDefault();\n    console.info('submitting btn');\n    try {\n      await commentPost(userpost._id, commentText, history);\n      setCommentText('');\n    } catch (error) {\n      console.log(error.message);\n    }\n  };\n\n  // const { location: { pathname, state } } = history;\n\n  const handleCommentTextChange = (e) => {\n    setCommentText(e.target.value);\n  };\n\n  if (isLoading && !userpost) {\n    return <p>Loading...</p>;\n  }\n\n  return (\n    <div className=\"post-page\">\n      <header>\n        <NavigationHeader />\n      </header>\n\n      <main>\n        <div className=\"post_content\">\n          <div className=\"post_image\">\n            <img src={userpost.postMedia} alt=\"image\" />\n          </div>\n          <div className=\"post_details\">\n            <div className=\"profile\">\n              <Profile\n                image={userpost.author.avatar}\n                iconSize=\"medium\"\n                username={userpost.author.username}\n              />\n              <Icon.MoreHorizontal className=\"more-icon\" size={26} />\n            </div>\n\n            {/* comment section */}\n            <div className=\"comment-section\">\n              {userpost.comments &&\n                userpost.comments.map((comment) => (\n                  <CommentList\n                    key={uuidv4()}\n                    commentId={comment._id}\n                    commentuser={comment._user}\n                    commentText={comment.commentText}\n                    userpost={userpost}\n                    accountName={comment.username}\n                    comment={comment.commentText}\n                    commentImage={comment.avatar}\n                    commentTime={comment.commentDate}\n                  />\n                ))}\n            </div>\n\n            {/* icons*/}\n            <div className=\"card_icon_menu\">\n              <div className=\"card-menu\">\n                <ExploreCardMenu\n                  userpost={userpost}\n                  focus={focus}\n                  likeFunc={likeFunc}\n                // isLiked={isLikedButtonClicked}\n                />\n              </div>\n              {!userpost.likes ? (\n                <small className=\"like-title\">\n                  {' '}\n                  Be the first to <b>like this</b>\n                </small>\n              ) : (\n                <small>{userpost.likes.length} Likes</small>\n              )}\n\n              <small className=\"post-date\">{moment(userpost.date).format('MMM D')}</small>\n            </div>\n\n            {/*  add a comment form */}\n            <form className=\"addComment\" onSubmit={handleCommentPost}>\n              <input\n                ref={inputRef}\n                value={commentText}\n                onChange={handleCommentTextChange}\n                type=\"text\"\n                placeholder=\"Add a comment...\"\n                className=\"commentText\"\n                name=\"commentText\"\n              />\n              <button disabled={commentText ? false : true} type=\"submit\" className=\"postText-btn\">\n                Post\n              </button>\n            </form>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\nconst mapStateToProps = ({ socket, post, user }) => {\n  return {\n    socket: socket.socket,\n    userpost: post.post,\n    user: user.currentUser,\n  };\n};\nexport default connect(mapStateToProps, { commentPost, getPosts, getSinglePost, likePost })(\n  withRouter(PostPage),\n);\n"]},"metadata":{},"sourceType":"module"}