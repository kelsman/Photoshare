{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{userActionTypes}from'../Constants/userConstants';import{setToken}from'../../utils';import{Redirect}from'react-router-dom';import axios from'axios';import cogoToast from'cogo-toast';import*as Routes from'../../component/routes';var baseUrl=process.env.REACT_APP_BASE_URL||'http://localhost:9000';export var signup=function signup(data,history){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{'Content-Type':'application/json'}};cogoToast.loading('Registering....');_context.next=5;return axios.post(\"/api/route/user/register\",config,data);case 5:response=_context.sent;if(!response){_context.next=11;break;}_context.next=9;return dispatch({type:userActionTypes.SIGN_UP_SUCESS,payload:response.data});case 9:cogoToast.success('Register successfully');history.push('/');case 11:_context.next=20;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0.message);if(!_context.t0.response){_context.next=20;break;}_context.next=19;return dispatch({type:userActionTypes.SIGN_UP_FAIL,payload:_context.t0.response.data});case 19:cogoToast.error(\"\".concat(_context.t0.response.data.msg));case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signin=function signin(data,history){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;config={headers:{'Content-Type':'application/json'}};_context2.next=4;return axios.post(\"/api/route/user/login\",data,config);case 4:response=_context2.sent;if(!response){_context2.next=13;break;}_context2.next=8;return dispatch({type:userActionTypes.LOG_IN_SUCCESS,payload:response.data});case 8:_context2.next=10;return localStorage.setItem('authToken',response.data.jwtToken);case 10:_context2.next=12;return cogoToast.success('sign in success',{position:'bottom-right'});case 12:history.push(Routes.Dashboard);case 13:_context2.next=21;break;case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](0);if(!_context2.t0.response){_context2.next=21;break;}_context2.next=20;return dispatch({type:userActionTypes.LOG_IN_FAIL,payload:_context2.t0.response.data});case 20:cogoToast.error(\"\".concat(_context2.t0.response.data.msg));case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,15]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var loaduser=function loaduser(history){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var token,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token=localStorage.getItem('authToken');_context3.prev=1;if(token){setToken(token);}_context3.next=5;return axios.get('/api/route/user/getUser');case 5:response=_context3.sent;if(!response){_context3.next=9;break;}_context3.next=9;return dispatch({type:userActionTypes.LOAD_USER_SUCCESS,payload:response.data.user[0]});case 9:_context3.next=18;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](1);if(!_context3.t0.response){_context3.next=18;break;}_context3.next=16;return dispatch({type:userActionTypes.LOAD_USER_FAIL,payload:_context3.t0.response.data});case 16:cogoToast.warn(\"\".concat(_context3.t0.response.data.msg),{position:'top-right'});if(_context3.t0.response.data.msg==='jwt expired'||_context3.t0.response.data.msg===\"you're not authorised\"){history.push('/');localStorage.removeItem('authToken');cogoToast.info('session expired');}case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[1,11]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var LogOut=function LogOut(history){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return localStorage.removeItem('authToken');case 3:dispatch({type:userActionTypes.LOG_OUT_SUCCESS,payload:'sign out sucessful'});history.push(Routes.Login);cogoToast.success('Sign out success');_context4.next=12;break;case 8:_context4.prev=8;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0.message);dispatch({type:userActionTypes.LOG_OUT_FAIL,payload:_context4.t0.message});case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,8]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/redux/Actions/userActions.js"],"names":["userActionTypes","setToken","Redirect","axios","cogoToast","Routes","baseUrl","process","env","REACT_APP_BASE_URL","signup","data","history","dispatch","config","headers","loading","post","response","type","SIGN_UP_SUCESS","payload","success","push","console","log","message","SIGN_UP_FAIL","error","msg","signin","LOG_IN_SUCCESS","localStorage","setItem","jwtToken","position","Dashboard","LOG_IN_FAIL","loaduser","token","getItem","get","LOAD_USER_SUCCESS","user","LOAD_USER_FAIL","warn","removeItem","info","LogOut","LOG_OUT_SUCCESS","Login","LOG_OUT_FAIL"],"mappings":"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","sourcesContent":["import { userActionTypes } from '../Constants/userConstants';\nimport { setToken } from '../../utils';\nimport { Redirect } from 'react-router-dom';\n\nimport axios from 'axios';\nimport cogoToast from 'cogo-toast';\nimport * as Routes from '../../component/routes';\n\nconst baseUrl = process.env.REACT_APP_BASE_URL || 'http://localhost:9000';\n\nexport const signup = (data, history) => {\n  return async (dispatch) => {\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      };\n      cogoToast.loading('Registering....');\n      const response = await axios.post(`/api/route/user/register`, config, data);\n      if (response) {\n        await dispatch({ type: userActionTypes.SIGN_UP_SUCESS, payload: response.data });\n        cogoToast.success('Register successfully');\n        history.push('/');\n      }\n    } catch (error) {\n      console.log(error.message);\n      if (error.response) {\n        await dispatch({ type: userActionTypes.SIGN_UP_FAIL, payload: error.response.data });\n        cogoToast.error(`${error.response.data.msg}`);\n      }\n    }\n  };\n};\n\nexport const signin = (data, history) => {\n  return async (dispatch) => {\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      };\n      const response = await axios.post(`/api/route/user/login`, data, config);\n      if (response) {\n        await dispatch({ type: userActionTypes.LOG_IN_SUCCESS, payload: response.data });\n        await localStorage.setItem('authToken', response.data.jwtToken);\n        await cogoToast.success('sign in success', { position: 'bottom-right' });\n        history.push(Routes.Dashboard);\n      }\n    } catch (error) {\n      if (error.response) {\n        await dispatch({ type: userActionTypes.LOG_IN_FAIL, payload: error.response.data });\n        cogoToast.error(`${error.response.data.msg}`);\n      }\n    }\n  };\n};\n\nexport const loaduser = (history) => {\n  return async (dispatch) => {\n    const token = localStorage.getItem('authToken');\n\n    try {\n      if (token) {\n        setToken(token);\n      }\n      const response = await axios.get('/api/route/user/getUser');\n      if (response) {\n        await dispatch({ type: userActionTypes.LOAD_USER_SUCCESS, payload: response.data.user[0] });\n      }\n    } catch (error) {\n      if (error.response) {\n        await dispatch({ type: userActionTypes.LOAD_USER_FAIL, payload: error.response.data });\n        cogoToast.warn(`${error.response.data.msg}`, { position: 'top-right' });\n        if (\n          error.response.data.msg === 'jwt expired' ||\n          error.response.data.msg === `you're not authorised`\n        ) {\n          history.push('/');\n          localStorage.removeItem('authToken');\n          cogoToast.info('session expired');\n        }\n      }\n    }\n  };\n};\n\nexport const LogOut = (history) => {\n  return async (dispatch) => {\n    try {\n      await localStorage.removeItem('authToken');\n      dispatch({ type: userActionTypes.LOG_OUT_SUCCESS, payload: 'sign out sucessful' });\n      history.push(Routes.Login);\n      cogoToast.success('Sign out success');\n    } catch (error) {\n      console.log(error.message);\n      dispatch({ type: userActionTypes.LOG_OUT_FAIL, payload: error.message });\n    }\n  };\n};\n"]},"metadata":{},"sourceType":"module"}