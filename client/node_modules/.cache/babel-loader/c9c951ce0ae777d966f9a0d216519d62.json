{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/mern stack/photoShare/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,Fragment,useEffect}from'react';import'./style.scss';import{useSelector,useDispatch}from'react-redux';import{ReactComponent as LoaderSvg}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/loader.svg\";import axios from'axios';import CogoToast from'cogo-toast';import{setToken}from'../../utils';import cogoToast from'cogo-toast';import Loader from'../Loader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var token=localStorage.getItem('authToken');var FollowButton=function FollowButton(_ref){var userId=_ref.userId;var dispatch=useDispatch();var currentUser=useSelector(function(_ref2){var user=_ref2.user;return user.currentUser;});var _useState=useState(null),_useState2=_slicedToArray(_useState,2),following=_useState2[0],setFollowed=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var handleUnfollow=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(token){setToken(token);}_context.prev=1;setLoading(true);_context.next=5;return axios.post(\"/api/route/user/unfollow/\".concat(userId));case 5:response=_context.sent;if(response){cogoToast.success(\"\".concat(response.data.msg));setLoading(false);setFollowed(false);}_context.next=14;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);console.log(_context.t0);setLoading(false);if(_context.t0.response){cogoToast.error(\"\".concat(_context.t0.response.data.msg));}case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function handleUnfollow(){return _ref3.apply(this,arguments);};}();var handleFollow=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(token){setToken(token);}_context2.prev=1;setLoading(true);_context2.next=5;return axios.post(\"/api/route/user/follow/\".concat(userId));case 5:response=_context2.sent;if(response){cogoToast.success(\"\".concat(response.data.msg));setLoading(false);setFollowed(true);}_context2.next=14;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);setLoading(false);if(_context2.t0.response){cogoToast.error(\"\".concat(_context2.t0.response.data.msg));}case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function handleFollow(){return _ref4.apply(this,arguments);};}();useEffect(function(){if(currentUser){var isFollowed=currentUser.following.find(function(follow){return follow.user===userId;});if(isFollowed){setFollowed(true);}else{setFollowed(false);}}return function(){return null;};},[]);if(currentUser&&currentUser._id==userId){return/*#__PURE__*/_jsx(\"button\",{disabled:true,children:\"follow\"});}if(following){return/*#__PURE__*/_jsxs(\"button\",{className:\"follow_btn\",onClick:handleUnfollow,children:[\"UnFollow\",loading&&/*#__PURE__*/_jsx(LoaderSvg,{})]});}return/*#__PURE__*/_jsx(Fragment,{children:!following&&/*#__PURE__*/_jsxs(\"button\",{className:\"follow_btn\",onClick:handleFollow,children:[\"Follow\",loading&&/*#__PURE__*/_jsx(LoaderSvg,{})]})});};export default FollowButton;","map":{"version":3,"sources":["/Users/mac/Documents/mern stack/photoShare/client/src/component/FollowButton/index.js"],"names":["React","useState","Fragment","useEffect","useSelector","useDispatch","axios","CogoToast","setToken","cogoToast","Loader","token","localStorage","getItem","FollowButton","userId","dispatch","currentUser","user","following","setFollowed","loading","setLoading","handleUnfollow","post","response","success","data","msg","console","log","error","handleFollow","isFollowed","find","follow","_id"],"mappings":"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","sourcesContent":["import React, { useState, Fragment, useEffect } from 'react';\nimport './style.scss';\n\nimport { useSelector, useDispatch } from 'react-redux';\nimport { ReactComponent as LoaderSvg } from '../../assets/loader.svg';\nimport axios from 'axios';\nimport CogoToast from 'cogo-toast';\nimport { setToken } from '../../utils';\nimport cogoToast from 'cogo-toast';\nimport Loader from '../Loader';\nconst token = localStorage.getItem('authToken');\n\nconst FollowButton = ({ userId }) => {\n  const dispatch = useDispatch();\n  const currentUser = useSelector(({ user }) => user.currentUser);\n\n  const [following, setFollowed] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const handleUnfollow = async () => {\n    if (token) {\n      setToken(token);\n    }\n    try {\n      setLoading(true);\n      const response = await axios.post(`/api/route/user/unfollow/${userId}`);\n      if (response) {\n        cogoToast.success(`${response.data.msg}`);\n        setLoading(false);\n        setFollowed(false);\n      }\n    } catch (error) {\n      console.log(error);\n      setLoading(false);\n      if (error.response) {\n        cogoToast.error(`${error.response.data.msg}`);\n      }\n    }\n  };\n  const handleFollow = async () => {\n    if (token) {\n      setToken(token);\n    }\n    try {\n      setLoading(true);\n      const response = await axios.post(`/api/route/user/follow/${userId}`);\n      if (response) {\n        cogoToast.success(`${response.data.msg}`);\n        setLoading(false);\n        setFollowed(true);\n      }\n    } catch (error) {\n      console.log(error);\n      setLoading(false);\n      if (error.response) {\n        cogoToast.error(`${error.response.data.msg}`);\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (currentUser) {\n      const isFollowed = currentUser.following.find((follow) => follow.user === userId);\n      if (isFollowed) {\n        setFollowed(true);\n      } else {\n        setFollowed(false);\n      }\n    }\n\n    return () => null;\n  }, []);\n\n  if (currentUser && currentUser._id == userId) {\n    return <button disabled>follow</button>;\n  }\n  if (following) {\n    return (\n      <button className=\"follow_btn\" onClick={handleUnfollow}>\n        UnFollow\n        {loading && <LoaderSvg />}\n      </button>\n    );\n  }\n  return (\n    <Fragment>\n      {!following && (\n        <button className=\"follow_btn\" onClick={handleFollow}>\n          Follow\n          {loading && <LoaderSvg />}\n        </button>\n      )}\n    </Fragment>\n  );\n};\n\nexport default FollowButton;\n"]},"metadata":{},"sourceType":"module"}